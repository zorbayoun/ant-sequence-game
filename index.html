
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>개미수열 게임</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background-color: #f5f5f5;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }

    #gameContainer {
      text-align: center;
      width: 90%;
      max-width: 600px;
    }

    #antCharacter img {
      width: 100px;
      height: auto;
      margin-bottom: 10px;
    }

    #sequence, #userInputDisplay {
      letter-spacing: 8px;
      white-space: nowrap;
      overflow-x: auto;
      margin-bottom: 10px;
    }

    #sequence {
      color: #555;
    }

    #userInputDisplay {
      color: #000;
      min-height: 2rem;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    #userInputDisplay::-webkit-scrollbar {
      display: none;
    }

    #timer, #score, #level, #message {
      margin-bottom: 5px;
    }

    button {
      padding: 10px 20px;
      font-size: 1rem;
      margin: 5px;
      cursor: pointer;
    }

    .keypad-button {
      width: 60px;
      height: 60px;
      font-size: 1.5rem;
      font-weight: bold;
      border: 2px solid #333;
      border-radius: 10px;
      background-color: white;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .keypad-button:active {
      background-color: #e0e0e0;
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <div id="antCharacter">
      <img id="antImage" src="images/Ant1.png" alt="Ant Character" />
    </div>
    <div id="level">레벨: 1</div>
    <div id="score">점수: 0</div>
    <div id="timer">제한시간: 10초</div>
    <div id="message"></div>
    <div id="sequence"></div>
    <div id="userInputDisplay"></div>
    <div id="mobileKeypad">
      <button class="keypad-button" onclick="checkInput('1')">1</button>
      <button class="keypad-button" onclick="checkInput('2')">2</button>
      <button class="keypad-button" onclick="checkInput('3')">3</button>
    </div>
  </div>

  <script>
    let currentSequence = '1';
    let nextSequence = '';
    let userInput = '';
    let level = 1;
    let score = 0;

    function nextAntSequence(seq) {
      let result = '';
      let i = 0;
      while (i < seq.length) {
        let count = 1;
        while (i + 1 < seq.length && seq[i] === seq[i + 1]) {
          i++;
          count++;
        }
        result += seq[i] + count;
        i++;
      }
      return result;
    }

    function displaySequence() {
      const sequenceEl = document.getElementById('sequence');
      sequenceEl.textContent = currentSequence;
      adjustSequenceFontSize(currentSequence.length);
      document.getElementById('userInputDisplay').textContent = '';
      nextSequence = nextAntSequence(currentSequence);
      userInput = '';
    }

    function adjustSequenceFontSize(charCount) {
      const el = document.getElementById('sequence');
      const containerWidth = el.parentElement.offsetWidth;
      const targetWidth = containerWidth * 0.9;
      const approxFontSize = Math.min(32, targetWidth / (charCount * 0.6));
      el.style.fontSize = approxFontSize + 'px';
    }

    function checkInput(key) {
      if (!'123'.includes(key)) return;
      userInput += key;
      const inputEl = document.getElementById('userInputDisplay');
      inputEl.textContent = userInput;
      inputEl.scrollLeft = inputEl.scrollWidth;

      const correctInput = nextSequence.slice(0, userInput.length);
      if (userInput === nextSequence) {
        score += nextSequence.length;
        level++;
        document.getElementById('score').textContent = '점수: ' + score;
        document.getElementById('level').textContent = '레벨: ' + level;
        updateAntCharacterImage(level);
        currentSequence = nextSequence;
        displaySequence();
      } else if (userInput !== correctInput) {
        alert('틀렸습니다! 다시 시작합니다.');
        location.reload();
      }
    }

    function updateAntCharacterImage(level) {
      const img = document.getElementById('antImage');
      if (level >= 11) img.src = 'images/Ant6.png';
      else if (level >= 9) img.src = 'images/Ant5.png';
      else if (level >= 7) img.src = 'images/Ant4.png';
      else if (level >= 5) img.src = 'images/Ant3.png';
      else if (level >= 3) img.src = 'images/Ant2.png';
      else img.src = 'images/Ant1.png';
    }

    document.addEventListener('keydown', (e) => checkInput(e.key));
    displaySequence();
  </script>
</body>
</html>
