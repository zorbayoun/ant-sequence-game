<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê°œë¯¸ìˆ˜ì—´ ê²Œì„</title>
  <style>
    @import url('https://fastly.jsdelivr.net/npm/galmuri@latest/dist/galmuri.css');

    /* body: ë°°ê²½ ì´ë¯¸ì§€ì™€ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì„¤ì • (ì´ë¯¸ì§€ê°€ ì—†ì„ ë•Œ #000 ë°°ê²½ìƒ‰) */
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: 'Galmuri9', 'GalmuriMono', sans-serif;
      overflow: hidden;
      /* ë°°ê²½ ì´ë¯¸ì§€ì™€ fallback ë°°ê²½ìƒ‰ì„ í•œ ë²ˆì— ì„¤ì • */
      background: #000 url('images/background.png') no-repeat center/contain;
    }

    /* ëª¨ë°”ì¼ í™”ë©´: ë°°ê²½ ì´ë¯¸ì§€ë¥¼ coverë¡œ í™•ëŒ€ */
    @media (max-width: 768px) {
      body {
        background-size: cover;
      }
    }
    
    #gameContainer {
      text-align: center;
      width: 90%;
      max-width: 600px;
    }

    #antCharacter img {
      width: 100px;
      height: auto;
      margin-bottom: 10px;
    }

    /* ìˆ˜ì—´ ë° ì‚¬ìš©ì ì…ë ¥ í‘œì‹œ ì˜ì—­ */
    #sequence, #userInputDisplay {
      font-size: 2rem;
      letter-spacing: 8px;
      white-space: nowrap;
      overflow-x: auto;
      margin-bottom: 10px;
    }

    #userInputDisplay {
      color: #000;
      min-height: 2rem;
      /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ ì²˜ë¦¬ */
      scrollbar-width: none;        /* Firefox */
      -ms-overflow-style: none;       /* IE 10+ */
    }

    #sequence {
      color: #555;
      overflow-x: hidden;
      max-width: 100%;
      display: inline-block;
    }

    /* ì›¹í‚· ë¸Œë¼ìš°ì €ì—ì„œ ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ */
    #userInputDisplay::-webkit-scrollbar {
      display: none;
    }
    
    #timer, #score, #level, #message {
      margin-bottom: 5px;
    }

    /* ê¸°ë³¸ ë²„íŠ¼ ìŠ¤íƒ€ì¼ì„ ì œê±°í•œ í›„, system-button í´ë˜ìŠ¤ë¡œ ì´ë¯¸ì§€ ë°°ê²½ ì ìš© */
    .system-button {
      background: url('images/button4.png') no-repeat center center;
      background-size: contain;
      border: none;
      color: black; 
      font-size: 1rem;
      font-family: 'Galmuri7', sans-serif;
      padding: 15px 20px;
      cursor: pointer;
      min-width: 100px;
    }

    /* ë²„íŠ¼ í…ìŠ¤íŠ¸ì˜ ê°€ë…ì„±ì„ ìœ„í•œ í…ìŠ¤íŠ¸ ê·¸ë¦¼ì íš¨ê³¼ */
    .system-button {
      text-shadow: 1px 0px  rgba(0,0,0,0.5);
    }

    /* ì˜¤ë²„ë ˆì´(ì¼ì‹œì •ì§€, ê²Œì„ ì˜¤ë²„, íŠœí† ë¦¬ì–¼) ìŠ¤íƒ€ì¼ */
    #pauseOverlay, #gameOverOverlay, #tutorialOverlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 999;
      font-size: 1.2rem;
      text-align: center;
    }

    #pauseOverlay {
      background-color: rgba(255, 255, 255, 0.9);
    }

    #gameOverOverlay {
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
    }

    #tutorialOverlay {
      background-color: rgba(0,0,0,0.8);
      color: white;
      font-size: 1rem;
    }

    #tutorialOverlay button {
      margin-top: 20px;
    }

    /* ëª¨ë°”ì¼ í‚¤íŒ¨ë“œ ì˜ì—­ */
    #mobileKeypad {
      display: flex;
      justify-content: center;
      margin-top: 20px;

      gap: 10px;
    }

    /* ëª¨ë°”ì¼ í‚¤íŒ¨ë“œì˜ ì´ë¯¸ì§€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .keypad-button {
      width: 60px;
      height: 60px;
      border: 0px solid #333;
      border-radius: 10px;
      box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);

      cursor: pointer;
    }

    @media (max-width: 500px) {
      .keypad-button {
        width: 50px;
        height: 50px;
        margin-left: 5px;
        margin-right: 5px;
      }
    }
    
    #startButtons {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <!-- ê°œë¯¸ ìºë¦­í„° ì´ë¯¸ì§€ -->
    <div id="antCharacter">
      <img id="antImage" src="images/Ant1.png" alt="Ant Character" />
    </div>
    <!-- ê²Œì„ ìƒíƒœ í‘œì‹œ -->
    <div id="level">ë ˆë²¨: 1</div>
    <div id="score">ì ìˆ˜: 0</div>
    <div id="timer">ì œí•œì‹œê°„: 10ì´ˆ</div>
    <div id="message"></div>
    <!-- ìˆ˜ì—´ ë° ì‚¬ìš©ì ì…ë ¥ í‘œì‹œ -->
    <div id="sequence"></div>
    <div id="userInputDisplay"></div>

    <!-- ì‹œì‘í™”ë©´ ë²„íŠ¼ -->
    <div id="startButtons">
      <button id="tutorialButton" class="system-button" onclick="showTutorial()">Tutorial</button>
      <button id="startButton" class="system-button" onclick="startGame()">Start</button>
    </div>

    <!-- ê²Œì„ ì¼ì‹œì •ì§€ ë²„íŠ¼ (ê²Œì„ ì‹œì‘ í›„ í‘œì‹œ) -->
    <button id="pauseButton" class="system-button" onclick="togglePause()" style="display:none;">Pause</button>

    <!-- ëª¨ë°”ì¼ í‚¤íŒ¨ë“œ: ê¸°ì¡´ ë²„íŠ¼ ëŒ€ì‹  ì´ë¯¸ì§€ ì‚¬ìš© -->
    <div id="mobileKeypad">
      <img class="keypad-button" src="images/button1.png" alt="ë²„íŠ¼ 1" onclick="checkInput('1')">
      <img class="keypad-button" src="images/button2.png" alt="ë²„íŠ¼ 2" onclick="checkInput('2')">
      <img class="keypad-button" src="images/button3.png" alt="ë²„íŠ¼ 3" onclick="checkInput('3')">
    </div>
  </div>

  <!-- Pause Overlay -->
  <div id="pauseOverlay">
    <div>Pause ì¤‘</div><br>
    <button class="system-button" onclick="togglePause()">Continue</button>
    <button class="system-button" onclick="resetGame()">Restart</button>
  </div>

  <!-- Game Over Overlay -->
  <div id="gameOverOverlay">
    <div id="gameOverText"></div><br>
    <button class="system-button" onclick="resetGame()">Restart</button>
  </div>

  <!-- Tutorial Overlay -->
  <div id="tutorialOverlay">
    <div>
      ê°œë¯¸ìˆ˜ì—´ì€ â€˜ë³´ëŠ” ëŒ€ë¡œ ë§í•˜ëŠ” ìˆ˜ì—´â€™ì´ì—ìš”.<br><br>
      ex) 1ì„ ë³´ë©´ â†’ "1ì´ 1ê°œ ìˆì–´ìš”" â†’ 11<br>
      ex) 11ì„ ë³´ë©´ â†’ "1ì´ 2ê°œ ìˆì–´ìš”" â†’ 12<br>
      ex) 1121ì„ ë³´ë©´ â†’ "1ì´ 2ê°œ, 2ê°€ 1ê°œ, 1ì´ 1ê°œ ìˆì–´ìš”" â†’ 122111
    </div>
    <button class="system-button" onclick="hideTutorial()">ë‹«ê¸°</button>
  </div>

  <script>
    //ì‚¬ìš´ë“œ
    const keyClickSound = new Audio('sound/click2.mp3');

    // ê°œë¯¸ìˆ˜ì—´ ê²Œì„ ì´ˆê¸° ì„¤ì •
    let currentSequence = '1', nextSequence = '', userInput = '';
    let level = 1, score = 0, timer, paused = false;
    const timeLimit = 10;
    
    // ë‹¤ìŒ ê°œë¯¸ìˆ˜ì—´(look-and-say sequence)ì„ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜
    function nextAntSequence(seq) {
      let result = '', i = 0;
      while (i < seq.length) {
        let count = 1;
        while (i + 1 < seq.length && seq[i] === seq[i + 1]) { 
          i++; 
          count++; 
        }
        result += seq[i] + count;
        i++;
      }
      return result;
    }

    // í˜„ì¬ ìˆ˜ì—´ ë° ì‚¬ìš©ì ì…ë ¥ì„ ì´ˆê¸°í™”í•˜ê³  í™”ë©´ì— í‘œì‹œí•œ í›„ íƒ€ì´ë¨¸ì™€ í°íŠ¸ ì¡°ì •ì„ í˜¸ì¶œ
    function displaySequence() {
      document.getElementById('sequence').textContent = currentSequence;
      document.getElementById('userInputDisplay').textContent = '';
      nextSequence = nextAntSequence(currentSequence);
      userInput = '';
      resetTimer();
      adjustSequenceFontSize();
    }

    // ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬ í•¨ìˆ˜
    function checkInput(key) {
      // '1', '2', '3' ì™¸ì˜ í‚¤ ì…ë ¥ í˜¹ì€ ì¼ì‹œì •ì§€ ìƒíƒœì—ì„œëŠ” ë¬´ì‹œ
      if (paused || !'123'.includes(key)) return;
      
      
  // ğŸµ í´ë¦­ ì‚¬ìš´ë“œ ì¬ìƒ
  keyClickSound.currentTime = 0; // ì¤‘ì²© ë°©ì§€ (ë¹ ë¥¸ ì—°ì† ì…ë ¥ ëŒ€ì‘)
  keyClickSound.play();

  // ê¸°ì¡´ ë¡œì§ ì´ì–´ì„œ...
      userInput += key;
      const inputEl = document.getElementById('userInputDisplay');
      inputEl.textContent = userInput;
      inputEl.offsetWidth; // ë¦¬í”Œë¡œìš° ê°•ì œ ë°œìƒ (ìŠ¤í¬ë¡¤ ê°±ì‹ )
      inputEl.scrollLeft = inputEl.scrollWidth;
      
      const correctInput = nextSequence.slice(0, userInput.length);
      if (userInput !== correctInput) {
        showGameOver();
      } else if (userInput === nextSequence) {
        score += nextSequence.length;
        level++;
        document.getElementById('score').textContent = 'ì ìˆ˜: ' + score;
        document.getElementById('level').textContent = 'ë ˆë²¨: ' + level;
        updateAntCharacterImage(level);
        currentSequence = nextSequence;
        displaySequence();
      }
    }

    // ë ˆë²¨ì— ë”°ë¼ ê°œë¯¸ ìºë¦­í„° ì´ë¯¸ì§€ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
    function updateAntCharacterImage(level) {
      const img = document.getElementById('antImage');
      if (level >= 13) img.src = 'images/Ant6.png';
      else if (level >= 11) img.src = 'images/Ant5.png';
      else if (level >= 9) img.src = 'images/Ant4.png';
      else if (level >= 7) img.src = 'images/Ant3.png';
      else if (level >= 4) img.src = 'images/Ant2.png';
      else img.src = 'images/Ant1.png';
    }

    // íƒ€ì´ë¨¸ ì´ˆê¸°í™” ë° ì‹œì‘ í•¨ìˆ˜
    function resetTimer() {
      clearInterval(timer);
      let timeLeft = timeLimit;
      document.getElementById('timer').textContent = 'ì œí•œì‹œê°„: ' + timeLeft + 'ì´ˆ';
      timer = setInterval(() => {
        if (!paused && --timeLeft <= 0) {
          clearInterval(timer);
          showGameOver();
        }
        document.getElementById('timer').textContent = 'ì œí•œì‹œê°„: ' + timeLeft + 'ì´ˆ';
      }, 1000);
    }

    // ê²Œì„ ì˜¤ë²„ ì²˜ë¦¬ í•¨ìˆ˜
    function showGameOver() {
      clearInterval(timer);
      document.getElementById('gameOverText').innerText = `Game Over!\në ˆë²¨: ${level}, ì ìˆ˜: ${score}`;
      document.getElementById('gameOverOverlay').style.display = 'flex';
    }

    // ê²Œì„ ì¼ì‹œì •ì§€ í† ê¸€ í•¨ìˆ˜
    function togglePause() {
      paused = !paused;
      document.getElementById('pauseOverlay').style.display = paused ? 'flex' : 'none';
    }

    // ê²Œì„ ì´ˆê¸°í™” ë° ì¬ì‹œì‘ í•¨ìˆ˜
    function resetGame() {
      currentSequence = '1';
      level = 1;
      score = 0;
      userInput = '';
      paused = false;
      clearInterval(timer);

      document.getElementById('score').textContent = 'ì ìˆ˜: 0';
      document.getElementById('level').textContent = 'ë ˆë²¨: 1';
      document.getElementById('timer').textContent = 'ì œí•œì‹œê°„: 10ì´ˆ';
      document.getElementById('message').textContent = '';
      document.getElementById('sequence').textContent = '';
      document.getElementById('userInputDisplay').textContent = '';
      document.getElementById('startButton').style.display = 'inline-block';
      document.getElementById('tutorialButton').style.display = 'inline-block';
      document.getElementById('pauseButton').style.display = 'none';
      document.getElementById('pauseOverlay').style.display = 'none';
      document.getElementById('gameOverOverlay').style.display = 'none';

      updateAntCharacterImage(level);
    }

    // ê²Œì„ ì‹œì‘ í•¨ìˆ˜
    function startGame() {
      document.getElementById('startButton').style.display = 'none';
      document.getElementById('tutorialButton').style.display = 'none';
      document.getElementById('pauseButton').style.display = 'inline-block';
      updateAntCharacterImage(level);
      displaySequence();
    }

    // íŠœí† ë¦¬ì–¼ í‘œì‹œ ë° ìˆ¨ê¹€ í•¨ìˆ˜
    function showTutorial() {
      document.getElementById('tutorialOverlay').style.display = 'flex';
    }

    function hideTutorial() {
      document.getElementById('tutorialOverlay').style.display = 'none';
    }

    // ìˆ˜ì—´ì˜ í°íŠ¸ í¬ê¸°ë¥¼ ì¡°ì •í•˜ë©°, ëª¨ë°”ì¼ í™˜ê²½ì—ì„œ ë ˆë²¨ 11 ì´ìƒì¸ ê²½ìš° ê³ ì • í°íŠ¸ ë° ë‘ ì¤„ í‘œì‹œ
    function adjustSequenceFontSize() {
      const el = document.getElementById('sequence');
      requestAnimationFrame(() => {
        if (window.innerWidth <= 768 && level >= 11) {
          el.style.fontSize = '18px'; // ê³ ì • í°íŠ¸ ì‚¬ì´ì¦ˆ
          const seq = currentSequence;
          const halfLength = Math.ceil(seq.length / 2);
          el.innerHTML = seq.slice(0, halfLength) + '<br>' + seq.slice(halfLength);
        } else {
          el.textContent = currentSequence;
          if (window.innerWidth <= 768) {
            const parentWidth = el.parentElement.offsetWidth;
            const charCount = currentSequence.length;
            const calculatedSize = parentWidth / (charCount * 1.2);
            const fontSize = Math.min(32, Math.max(16, calculatedSize));
            el.style.fontSize = fontSize + 'px';
          } else {
            el.style.fontSize = '2rem';
          }
        }
      });
    }

document.addEventListener('keydown', function (e) {
  // ëª¨ë°”ì¼ì—ì„œëŠ” í‚¤ë‹¤ìš´ ì´ë²¤íŠ¸ë¥¼ ë¬´ì‹œí•˜ê³ , PCì—ì„œëŠ” ì²˜ë¦¬í•©ë‹ˆë‹¤.
  if (window.innerWidth <= 768) return;  

  if (e.key === 'Enter') {
    const gameOverVisible = document.getElementById('gameOverOverlay').style.display === 'flex';
    const pauseVisible = document.getElementById('pauseOverlay').style.display === 'flex';
    const startVisible = document.getElementById('startButton').style.display !== 'none';

    if (gameOverVisible) resetGame();
    else if (pauseVisible) togglePause();
    else if (startVisible) startGame();
  }
  checkInput(e.key);
});


    // ì´ˆê¸°í™”: ê²Œì„ ì‹œì‘ ì „ì— ì´ˆê¸° ìƒíƒœ ì„¤ì •
    resetGame();
  </script>
</body>
</html>